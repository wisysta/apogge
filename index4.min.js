function setViewportHeight(){const t=.01*(window.visualViewport?window.visualViewport.height:window.innerHeight);document.documentElement.style.setProperty("--vh",`${t}px`)}let initialHeight=window.innerHeight,isInitialized=!1;function initializeViewportHeight(){isInitialized||(setViewportHeight(),initialHeight=window.innerHeight,isInitialized=!0)}function initializeMainPage(){function t(){const t=document.getElementById("map-container");if(!t)return;const n=window.innerWidth<=768;fetch(n?"https://ecimg.cafe24img.com/pg2069b88099925051/cerezia/images/map-mo-final.svg":"https://ecimg.cafe24img.com/pg2069b88099925051/cerezia/images/map-pc.svg").then(t=>t.text()).then(n=>{t.innerHTML=n,function(){const t=document.querySelector("#map-container svg");if(!t)return;const n=t.querySelector("#canada-round"),o=t.querySelector("#canada-circle"),i=t.querySelector("#newzealand-round"),s=t.querySelector("#newzealand-circle");n&&e(n,"0s");o&&e(o,"0.5s");i&&e(i,"0s");s&&e(s,"0.5s")}(),function(){const t=document.querySelector("#map-container svg");if(!t)return;const e=t.querySelector("#canada-circle"),n=t.querySelector("#canada-dottted-line"),o=t.querySelector("#canada-text"),i=t.querySelector("#newzealand-circle"),s=t.querySelector("#newzealand-dottted-line"),a=t.querySelector("#newzealand-text");let c={state:"idle",timers:[],touchActive:!1},r={state:"idle",timers:[],touchActive:!1};function l(){n&&(n.style.opacity="0",n.style.transition="opacity 0.5s ease"),o&&(o.style.opacity="0",o.style.transform="translateY(10px)",o.style.transition="opacity 0.4s ease, transform 0.4s ease"),s&&(s.style.opacity="0",s.style.transition="opacity 0.5s ease"),a&&(a.style.opacity="0",a.style.transform="translateY(10px)",a.style.transition="opacity 0.4s ease, transform 0.4s ease")}function d(){"showing"!==c.state&&"shown"!==c.state&&(y(),c.state="showing",m())}function u(){if(!c.touchActive){if("showing"===c.state){const t=setTimeout(()=>{p()},800);return void c.timers.push(t)}"hiding"!==c.state&&p()}}function m(){n&&(n.style.opacity="1");const t=setTimeout(()=>{o&&(o.style.opacity="1",o.style.transform="translateY(0)");const t=setTimeout(()=>{c.state="shown"},400);c.timers.push(t)},300);c.timers.push(t)}function p(){y(),c.state="hiding",o&&(o.style.opacity="0",o.style.transform="translateY(10px)");const t=setTimeout(()=>{n&&(n.style.opacity="0");const t=setTimeout(()=>{c.state="idle"},500);c.timers.push(t)},100);c.timers.push(t)}function y(){c.timers.forEach(t=>clearTimeout(t)),c.timers=[]}function f(){"showing"!==r.state&&"shown"!==r.state&&(v(),r.state="showing",h())}function w(){if(!r.touchActive){if("showing"===r.state){const t=setTimeout(()=>{g()},800);return void r.timers.push(t)}"hiding"!==r.state&&g()}}function h(){s&&(s.style.opacity="1");const t=setTimeout(()=>{a&&(a.style.opacity="1",a.style.transform="translateY(0)");const t=setTimeout(()=>{r.state="shown"},400);r.timers.push(t)},300);r.timers.push(t)}function g(){v(),r.state="hiding",a&&(a.style.opacity="0",a.style.transform="translateY(10px)");const t=setTimeout(()=>{s&&(s.style.opacity="0");const t=setTimeout(()=>{r.state="idle"},500);r.timers.push(t)},100);r.timers.push(t)}function v(){r.timers.forEach(t=>clearTimeout(t)),r.timers=[]}function b(){c.touchActive?(c.touchActive=!1,p()):(r.touchActive=!1,g(),c.touchActive=!0,d())}function S(){r.touchActive?(r.touchActive=!1,g()):(c.touchActive=!1,p(),r.touchActive=!0,f())}l(),e&&(e.addEventListener("mouseenter",d),e.addEventListener("mouseleave",u),e.addEventListener("click",b),e.addEventListener("touchend",function(t){t.preventDefault(),b()}),e.style.cursor="pointer");i&&(i.addEventListener("mouseenter",f),i.addEventListener("mouseleave",w),i.addEventListener("click",S),i.addEventListener("touchend",function(t){t.preventDefault(),S()}),i.style.cursor="pointer");document.addEventListener("click",function(t){const e=document.getElementById("map-container");e&&!e.contains(t.target)&&(c.touchActive=!1,r.touchActive=!1,p(),g())})}()}).catch(t=>{console.error("SVG 로드 실패:",t)})}function e(t,e){const n=document.createElementNS("http://www.w3.org/2000/svg","animate");n.setAttribute("attributeName","fill-opacity"),n.setAttribute("values","0.1;0.6;0.1"),n.setAttribute("dur","3s"),n.setAttribute("begin",e),n.setAttribute("repeatCount","indefinite"),t.appendChild(n)}let n={state:"idle",currentStep:"1",timers:[]};function o(){const t=document.querySelectorAll(".process-step");t.forEach(e=>{e.addEventListener("click",function(){const e=this.getAttribute("data-step");e!==n.currentStep&&"transitioning"!==n.state&&function(t,e){n.timers.forEach(t=>clearTimeout(t)),n.timers=[],n.state="transitioning",n.currentStep=t,e.forEach(t=>t.classList.remove("active"));const o=document.querySelector(`.process-step[data-step="${t}"]`);o&&o.classList.add("active");!function(t){const e=document.querySelectorAll(".process-image"),o=document.querySelector(`.process-image[data-step="${t}"]`),i=document.querySelector(".process-image.active");if(!o||o===i)return void(n.state="idle");i&&(i.classList.add("fade-out"),i.classList.remove("active"));o.style.transform="translateX(100%)",o.style.opacity="1",o.offsetHeight,o.classList.add("slide-in"),o.style.transform="translateX(0)";const s=setTimeout(()=>{e.forEach(t=>{t!==o&&(t.classList.remove("active","fade-out","slide-in"),t.style.opacity="0",t.style.transform="translateX(100%)")}),o.classList.remove("slide-in"),o.classList.add("active"),n.state="idle",console.log(`프로세스 스텝 ${t} 전환 완료`)},800);n.timers.push(s)}(t)}(e,t)})}),console.log(`프로세스 스텝 ${t.length}개 초기화 완료`)}async function i(){try{const t=await fetch("https://before-cafe24.vercel.app/api/apogee/news?page=1&limit=5");if(t.ok){const e=await t.json();e.success&&e.data&&function(t){const e=document.querySelector(".news-items");if(!e)return;t.forEach((t,n)=>{const o=document.createElement("article");o.className=0===n?"news-item featured":"news-item",t.link&&o.setAttribute("data-link",t.link),o.innerHTML=`\n                <h3>${t.title}</h3>\n                <div class="news-icon">\n                    <img src="https://ecimg.cafe24img.com/pg2069b88099925051/cerezia/images/symbol-small.svg" alt="News Icon">\n                </div>\n            `,e.appendChild(o)});document.querySelectorAll(".news-item").forEach(t=>{t.addEventListener("click",function(){const t=this.getAttribute("data-link");t&&window.open(t,"_blank"),this.style.transform="scale(0.98)",setTimeout(()=>{this.style.transform="scale(1)"},150)}),t.style.cursor="pointer",t.style.transition="transform 0.15s ease"})}(e.data)}}catch(t){console.error("뉴스 로드 중 오류 발생:",t)}}function s(){if(window.innerWidth<=768){document.querySelector(".nav-menu")}}let a=window.innerWidth<=768;function c(){const e=window.innerWidth<=768;a!==e&&(a=e,t())}!function(){const t=document.querySelector(".scroll-icon"),e=document.querySelector(".scroll-text");t&&t.addEventListener("click",function(){const t=document.getElementById("brand");if(t){const e=t.offsetTop;window.scrollTo({top:e,behavior:"smooth"})}}),e&&e.addEventListener("click",function(){const t=document.getElementById("brand");if(t){const e=t.offsetTop;window.scrollTo({top:e,behavior:"smooth"})}})}(),function(){const t=new IntersectionObserver(function(t){t.forEach(t=>{t.isIntersecting&&(t.target.style.opacity="1",t.target.style.transform="translateY(0)")})},{threshold:.1,rootMargin:"0px 0px -50px 0px"});document.querySelectorAll([".bw-product-item",".process-step",".origin-content",".news-item",".faq-item"].join(", ")).forEach((e,n)=>{e.style.opacity="0",e.style.transform="translateY(30px)",e.style.transition=`opacity 0.6s ease ${.1*n}s, transform 0.6s ease ${.1*n}s`,t.observe(e)})}(),o(),document.querySelectorAll(".bw-product-item").forEach(t=>{const e=t.querySelector(".bw-product-image");t.addEventListener("mouseenter",function(){e.style.transform="scale(1.05)",e.style.transition="transform 0.3s ease"}),t.addEventListener("mouseleave",function(){e.style.transform="scale(1)"})}),document.querySelectorAll(".map-dot").forEach((t,e)=>{setInterval(()=>{t.style.transform="scale(1.2)",t.style.boxShadow="0 0 20px rgba(229, 184, 116, 0.6)",setTimeout(()=>{t.style.transform="scale(1)",t.style.boxShadow="none"},1e3)},3e3+1500*e),t.style.transition="all 0.5s ease"}),i(),document.querySelectorAll(".btn").forEach(t=>{t.addEventListener("mouseenter",function(){this.style.transform="translateY(-2px)",this.style.boxShadow="0 4px 15px rgba(229, 184, 116, 0.3)"}),t.addEventListener("mouseleave",function(){this.style.transform="translateY(0)",this.style.boxShadow="none"}),t.addEventListener("mousedown",function(){this.style.transform="translateY(0)"}),t.addEventListener("mouseup",function(){this.style.transform="translateY(-2px)"})}),s(),function(){const t=document.createElement("div");t.style.cssText="\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 0%;\n            height: 3px;\n            background: linear-gradient(90deg, #E5B874, #37000A);\n            z-index: 9999;\n            transition: width 0.3s ease;\n        ",document.body.appendChild(t),window.addEventListener("scroll",function(){const e=window.scrollY/(document.documentElement.scrollHeight-window.innerHeight)*100;t.style.width=e+"%"})}(),initScrollAnimations(),initBWProductSwiper(),function(){const t=document.querySelector(".hero-content");t&&(t.style.opacity="0",t.style.transform="translateY(30px)",t.style.transition="opacity 1s ease, transform 1s ease",setTimeout(()=>{t.style.opacity="1",t.style.transform="translateY(0)",console.log("히어로 컨텐츠 나타남")},5500),setTimeout(()=>{t.style.opacity="0",t.style.transform="translateY(-30px)",console.log("히어로 컨텐츠 사라짐")},11e3))}(),t(),function(){const t={root:null,rootMargin:"-50px 0px",threshold:.1},e=new IntersectionObserver(function(t,e){t.forEach(t=>{if(t.isIntersecting){const n=t.target;n.classList.contains("bw-product-header")&&(n.classList.add("fade-in"),setTimeout(()=>{const t=document.querySelector(".bw-product-swiper");t&&(t.classList.add("fade-in"),setTimeout(()=>{document.querySelectorAll(".bw-product-card").forEach(t=>{t.classList.add("fade-in-stagger")})},400))},500)),e.unobserve(n)}})},t),n=new IntersectionObserver(function(t,e){t.forEach(t=>{t.isIntersecting&&(t.target.classList.add("visible"),e.unobserve(t.target))})},t),o=document.querySelector(".bw-product-header");o&&e.observe(o),document.querySelectorAll(".fade-in-element").forEach(t=>{n.observe(t)})}(),function(){const t=document.querySelectorAll('.nav-link[href="#main"], .nav-link[href="#brand"], .nav-link[href="#journey"]');t.forEach(t=>{t.addEventListener("click",function(t){t.preventDefault();const e=this.getAttribute("href").substring(1),n=document.getElementById(e);n&&window.scrollTo({top:n.offsetTop,behavior:"smooth"})})}),console.log(`Smooth scroll 적용 완료: ${t.length}개 링크`)}(),window.addEventListener("resize",c),console.log("아포제 웹사이트가 성공적으로 로드되었습니다."),window.addEventListener("resize",function(){s()})}function openContactModal(){const t=document.getElementById("contactModal");t&&(t.classList.add("active"),document.body.style.overflow="hidden")}function closeContactModal(){const t=document.getElementById("contactModal");if(t){t.classList.remove("active"),document.body.style.overflow="auto";const e=document.getElementById("contactForm");e&&e.reset(),selectContactType("개인")}}function openPrivacyModal(){const t=document.getElementById("privacyModal");t&&(t.classList.add("active"),document.body.style.overflow="hidden")}function closePrivacyModal(){const t=document.getElementById("privacyModal");t&&(t.classList.remove("active"),document.body.style.overflow="auto")}function agreeAndClosePrivacyModal(){const t=document.getElementById("privacy");t&&(t.checked=!0),validateContactForm(),closePrivacyModal()}function selectContactType(t){document.querySelectorAll(".contact-type-btn").forEach(t=>t.classList.remove("active"));const e=document.querySelector(`[data-type="${t}"]`);e&&e.classList.add("active");const n=document.getElementById("nameLabel"),o=document.getElementById("name");"개인"===t?(n.textContent="성함",o.placeholder="성함을 입력하세요"):(n.textContent="기업명",o.placeholder="기업명을 입력하세요")}async function submitContactForm(t){t.preventDefault();const e=t.target,n=new FormData(e),o={type:"개인"===(document.querySelector(".contact-type-btn.active")?.dataset.type||"개인")?"PERSONAL":"BUSINESS",name:n.get("name"),phone:n.get("phone"),content:n.get("message")};try{const t=await fetch("https://before-cafe24.vercel.app/api/apogee/contact",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(t.ok){await t.json();alert("문의사항이 성공적으로 접수되었습니다."),e.reset(),validateContactForm(),closeContactModal()}else{const e=await t.json().catch(()=>({}));let n="문의 전송에 실패했습니다.";switch(t.status){case 400:n="입력 정보를 확인해주세요. 필수 항목이 누락되었거나 형식이 올바르지 않습니다.";break;case 403:n="접근이 허용되지 않습니다.";break;case 404:n="서비스를 찾을 수 없습니다.";break;case 500:n="서버 오류가 발생했습니다. 잠시 후 다시 시도해주세요.";break;default:n=e.message||"문의 전송에 실패했습니다. 다시 시도해주세요."}alert(n)}}catch(t){console.error("Contact form submission error:",t),alert("네트워크 오류가 발생했습니다. 인터넷 연결을 확인하고 다시 시도해주세요.")}}function validateContactForm(){const t=document.getElementById("name"),e=document.getElementById("phone"),n=document.getElementById("message"),o=document.getElementById("privacy"),i=document.querySelector(".modal-submit-btn");if(!(t&&e&&n&&o&&i))return;const s=""!==t.value.trim(),a=""!==e.value.trim(),c=""!==n.value.trim(),r=o.checked;s&&a&&c&&r?i.classList.add("active"):i.classList.remove("active")}function addFormValidationListeners(){const t=document.getElementById("name"),e=document.getElementById("phone"),n=document.getElementById("message"),o=document.getElementById("privacy");t&&t.addEventListener("input",validateContactForm),e&&e.addEventListener("input",validateContactForm),n&&n.addEventListener("input",validateContactForm),o&&o.addEventListener("change",validateContactForm)}function initScrollAnimations(){document.querySelectorAll(".brand-left, .brand-content").forEach(t=>{console.log("초기 상태 설정:",t.className),t.style.opacity="0",t.classList.contains("brand-left")?t.style.transform="none":t.style.transform="translateY(100px)"});const t=new IntersectionObserver(t=>{t.forEach(t=>{if(t.isIntersecting){t.target.classList.contains("brand-intro")&&animateBrandElements()}})},{threshold:.2,rootMargin:"0px 0px -150px 0px"}),e=document.querySelector(".brand-intro");e&&t.observe(e)}function animateBrandElements(){const t=document.querySelector(".brand-left");t&&(t.style.transition="all 1.2s cubic-bezier(0.25, 0.46, 0.45, 0.94)",t.style.opacity="1",t.style.transform="none"),console.log("1.2초 타이머 설정됨"),setTimeout(()=>{const t=document.querySelector(".brand-content");t&&(t.style.transition="all 1.2s cubic-bezier(0.25, 0.46, 0.45, 0.94)",t.style.opacity="1",t.style.transform="translateY(0)")},800)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",initializeViewportHeight):initializeViewportHeight(),window.addEventListener("orientationchange",()=>{setTimeout(()=>{setViewportHeight(),initialHeight=window.innerHeight},100)}),window.visualViewport&&window.visualViewport.addEventListener("resize",()=>{const t=window.visualViewport.height;Math.abs(t-initialHeight)>100&&(setViewportHeight(),initialHeight=t)}),document.addEventListener("DOMContentLoaded",function(){window.ApogeeLoader&&document.getElementById("apogee-loader")||initializeMainPage()}),window.addEventListener("apogeeLoadingComplete",function(){initializeMainPage()}),window.ApogeeUtils={scrollToSection:function(t){const e=document.getElementById(t);if(e){const t=e.offsetTop-100;window.scrollTo({top:t,behavior:"smooth"})}},getCurrentSection:function(){const t=document.querySelectorAll("section[id]"),e=window.scrollY+150;for(let n of t){const t=n.offsetTop,o=n.offsetHeight;if(e>=t&&e<t+o)return n.getAttribute("id")}return null}},document.addEventListener("click",function(t){const e=document.getElementById("contactModal"),n=document.getElementById("privacyModal"),o=document.querySelector(".modal-panel"),i=document.querySelector(".privacy-modal-panel");e&&e.classList.contains("active")&&(t.target.classList.contains("modal-overlay")||t.target===e&&!o.contains(t.target))&&closeContactModal(),n&&n.classList.contains("active")&&(t.target.classList.contains("modal-overlay")||t.target===n&&!i.contains(t.target))&&closePrivacyModal()}),document.addEventListener("keydown",function(t){if("Escape"===t.key){const t=document.getElementById("contactModal"),e=document.getElementById("privacyModal");t&&t.classList.contains("active")&&closeContactModal(),e&&e.classList.contains("active")&&closePrivacyModal()}}),document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("contactForm");t&&(t.addEventListener("submit",submitContactForm),addFormValidationListeners(),validateContactForm())}),window.openContactModal=openContactModal,window.closeContactModal=closeContactModal,window.selectContactType=selectContactType,window.openPrivacyModal=openPrivacyModal,window.closePrivacyModal=closePrivacyModal,window.agreeAndClosePrivacyModal=agreeAndClosePrivacyModal;let bwProductSwiper=null;function initBWProductSwiper(){bwProductSwiper=new Swiper(".bw-product-swiper",{slidesPerView:2.3,spaceBetween:30,centeredSlides:!1,loop:!0,autoplay:{delay:1e3,disableOnInteraction:!1,pauseOnMouseEnter:!1},speed:800,breakpoints:{320:{slidesPerView:1.3,spaceBetween:10,centeredSlides:!1},768:{slidesPerView:1.5,spaceBetween:10,centeredSlides:!0},1024:{slidesPerView:2.3,spaceBetween:15,centeredSlides:!1},1400:{slidesPerView:2.3,spaceBetween:20,centeredSlides:!1}},pagination:{el:".bw-swiper-pagination",type:"progressbar"},grabCursor:!0,keyboard:{enabled:!0,onlyInViewport:!0},autoHeight:!1,effect:"slide",on:{init:function(){console.log("Product Swiper 초기화 완료"),this.autoplay.stop()},slideChange:function(){const t=this.slides[this.activeIndex];if(t){const e=t.querySelector(".bw-product-card");e&&(e.style.transform="scale(1.02)",setTimeout(()=>{e.style.transform="scale(1)"},300))}}}});const t=document.querySelector(".bw-product-section");if(t){new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting?bwProductSwiper&&!bwProductSwiper.autoplay.running&&(bwProductSwiper.autoplay.start(),console.log("Product Swiper 자동재생 시작")):bwProductSwiper&&bwProductSwiper.autoplay.running&&(bwProductSwiper.autoplay.stop(),console.log("Product Swiper 자동재생 중지"))})},{threshold:.3,rootMargin:"0px"}).observe(t)}}function startProductAutoplay(){bwProductSwiper&&bwProductSwiper.autoplay.start()}function stopProductAutoplay(){bwProductSwiper&&bwProductSwiper.autoplay.stop()}function nextProductSlide(){bwProductSwiper&&bwProductSwiper.slideNext()}function prevProductSlide(){bwProductSwiper&&bwProductSwiper.slidePrev()}window.startProductAutoplay=startProductAutoplay,window.stopProductAutoplay=stopProductAutoplay,window.nextProductSlide=nextProductSlide,window.prevProductSlide=prevProductSlide;